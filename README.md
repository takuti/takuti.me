[takuti.me](http://takuti.me)
===

@takuti's simple portfolio and blogging site generated by [Hugo](https://github.com/spf13/hugo).

## Overview

After generating site contents, the contents under *public/* will be deployed to the document root on my remote server.

All of these operations are defined as `rake` commands in Rakefile.

## Dependancies

### System

Hugo and direnv can be installed from homebrew:

```
$ brew install hugo
$ brew install direnv
```

### Ruby Gems

To compile Markdown files (including MathJax), we need to get two extra gems:

```
$ gem install kramdown
```

### Gulp

We will use gulp tasks to compile sass files, so required npm modules are:

```
$ npm install --global gulp
$ npm install --save-dev gulp
$ npm install gulp-sass
```

## Usage

I should create new contents in *_content/* directory for `rake` command, and sass files in *_scss/* directory for `gulp` command.

### Generate css from sass files

Gulp default task converts all .scss files under *_scss/* to css files in *static/style/* by: 

```
$ gulp
```

If you want to track style modification in real-time, run

```
$ gulp watch
```

and

```
$ hugo server --watch
```
at the same time.

### Generate site and check on my local environment

```
$ rake
```

What this command actually does are:

- [Kramdown](https://github.com/gettalong/kramdown) converts new Markdown+MathJax contents in *_content/* to html files in *content/*.
- Generate site contents and run Hugo server.

### Deploy generated site contents

By `direnv edit .` command, set environment variables as follows:

```sh
export RSYNC_PROGRAM=/path/to/remote/rsync/program
export RSYNC_DEST_PORT=22
export RSYNC_USER=username
export RSYNC_HOST=example.com
export RSYNC_DEST=/path/to/remote/document/root

export HUGO_BASE_URL=http://example.com/
```

Complete deploy procedure is:

```
$ rake prepare
$ rake rsync:test
$ rake rsync:sync
```

`rake prepare` command again runs Hugo server to generate site contents with production root url. And, you can finally deploy the contents using `rsync` commands.

## License

MIT